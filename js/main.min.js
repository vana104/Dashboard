function setValue(t,e,a,n,l,r){var i=100;t>i&&(i=t),e>i&&(i=e),a>i&&(i=a),n>i&&(i=n),l>i&&(i=l),r>i&&(i=r);var s=100*t/i,u=100*e/i,c=100*a/i,d=100*n/i,o=100*l/i,p=100*r/i;$("#bar1").animate({height:s+"%"},500),$("#bar2").animate({height:u+"%"},500),$("#bar3").animate({height:c+"%"},500),$("#bar4").animate({height:d+"%"},500),$("#bar5").animate({height:o+"%"},500),$("#bar6").animate({height:p+"%"},500)}function init(){for(oldValue=[],moving_id=null,d3.select("#rangebox tbody").html(""),i=0;i<nb_sliders;i++){var t=d3.select("#rangebox tbody").append("tr");t.append("td").attr("class","edit").attr("bgcolor",function(t,e){return color(e)}).attr("contenteditable",!0).text(""+(i+1)),t.append("td").append("input").attr("type","range").attr("data-id",i).attr("class","range").attr("step",1).attr("min",0).attr("max",100),t.append("td").attr("class","range_value")}d3.selectAll("#rangebox .range").each(function(){var t=parseInt(100/nb_sliders);this.value=t,oldValue[d3.select(this).attr("data-id")]=this.value}),equalize(),showValues(),pieChart(),seteditboxcolor(),d3.selectAll(".edit").on("input",function(){updateLabels()}),d3.selectAll(".range").on("input",function(){this.value=parseInt(this.value),this.value<0?this.value=0:this.value>100&&(this.value=100);var t=d3.select(this).attr("data-id"),e=oldValue[moving_id=t],a=this.value,n=(a-e)/(nb_sliders-1);d3.selectAll("#rangebox .range").each(function(){var t=d3.select(this).attr("data-id"),e=this.value;if(t!=moving_id&&e>n){var a=parseInt(e-n);this.value=a,oldValue[t]=this.value}}),oldValue[moving_id]=a,equalize(),showValues(),updatePieChart()})}function showHelp(){$(document).ready(function(){$("h5").css({opacity:".4"})})}function seteditboxcolor(){var t=[0,1,2,3,4,5,6,7,8,9];d3.selectAll(".edit").data(t).attr("bgcolor",function(t){return color(t)})}function getData(){var t=[];return d3.selectAll("#rangebox .range").each(function(){t.push({label:d3.select(this.parentNode.parentNode).select("td:first-child").text(),value:this.value})}),t}function getTotal(){var t=0;return d3.selectAll("#rangebox .range").each(function(){t+=parseInt(this.value)}),t}function equalize(){var t=100-getTotal();if(0!=t){var e=null,a=null,n=null,l=9999,r=0;console.log(t),d3.selectAll("#rangebox .range").each(function(){d3.select(this).attr("data-id")!=moving_id&&(parseInt(this.value)>parseInt(r)&&(r=this.value,n=this),parseInt(this.value)<parseInt(l)&&(l=this.value,a=this))}),(e=t>0?a:n)&&(t>0?(e.value=parseInt(e.value)+1,t-=1):(e.value=parseInt(e.value)-1,t+=1),oldValue[d3.select(e).attr("data-id")]=e.value,0!=t&&equalize())}}function showValues(){d3.selectAll("#rangebox .range").each(function(){var t=this.value+"%";d3.select(this.parentNode.nextSibling).html(t)})}function pieChart(){var t=getData();margin.left,margin.right,margin.top,margin.bottom;d3.select("#pie svg").remove();var e=d3.select("#pie").append("svg:svg").attr("width",canvasWidth).attr("height",canvasHeight).append("svg:g").attr("transform","translate("+canvasWidth/2+","+canvasHeight/2+")");d3.select("g").append("g").attr("class","slices"),d3.select("g").append("g").attr("class","labels"),d3.select("g").append("g").attr("class","lines"),d3.select("g").append("g").attr("class","legend"),e.select(".slices").selectAll("path").data(pie(getData())).enter().append("svg:path").attr("class","slice").attr("fill",function(t,e){return color(e)}).attr("d",arc).each(function(t){this._current=t}).append("title").text(function(e,a){return t[a].value+"%"}),e.select(".labels").selectAll("label").data(pie(getData())).enter().append("svg:text").attr("class","label").attr("transform",function(t){return"translate("+arc.centroid(t)+")"}).attr("text-anchor","middle").text(function(e,a){return t[a].value>1?t[a].label:null})}function updatePieChart(){updateArcs(),updateLabels(),updateLabelLines()}function updateArcs(){var t=getData();d3.selectAll("#pie path title").text(function(e,a){return t[a].value+"%"}),d3.selectAll("#pie path").data(pie(t)).transition().duration(100).attrTween("d",arcTween)}function updateLabels(){labelr=radius+40,d3.selectAll("#pie text").data(pie(getData())).transition().duration(120).attr("transform",function(t){var e=arc.centroid(t),a=e[0],n=e[1],l=Math.sqrt(a*a+n*n);return"translate("+a/l*labelr+","+n/l*labelr+")"}).attr("dy",".35em").attr("text-anchor",function(t){return(t.endAngle+t.startAngle)/2>Math.PI?"end":"start"}).text(function(t,e){return getData()[e].value>0?getData()[e].label:null})}function midAngle(t){return t.startAngle+(t.endAngle-t.startAngle)/2}function updateLabelLines(){var t=d3.select(".lines").selectAll("polyline").data(pie(getData()));t.enter().append("polyline"),t.transition().duration(100).attrTween("points",function(t){this._current=this._current||t;var e=d3.interpolate(this._current,t);return this._current=e(0),function(t){var a=e(t);return[arc.centroid(a),outerArc.centroid(a)]}}),t.exit().remove()}function arcTween(t){var e=d3.interpolate(this._current,t);return this._current=e(0),function(t){return arc(e(t))}}var users=[{id:1,first_name:"John",last_name:"Doe",email:"jdoe@fuck.it"}],templates=[{id:1,name:"Dark",value:"css/dark.css",logo:"css/dark.css"},{id:2,name:"Light",value:"css/light.css",logo:"css/light.css"}],app=new Vue({el:"#app",data:{title:"Dashboard",users:users,templates:templates,default_template:2,current_template:templates[1]},methods:{setTemplate:function(t){var e=this.templates.filter(function(e){return e.id==t})[0];this.current_template=e},tableHeader:function(t){var e=[];for(key in t[0])e.push(key);return e}}});$(".bar_val").keyup(function(){setValue(~~$("#bar1_val").val(),~~$("#bar2_val").val(),~~$("#bar3_val").val(),~~$("#bar4_val").val(),~~$("#bar5_val").val(),~~$("#bar6_val").val())});var nb_sliders=null,moving_id=null,oldValue=[],radius=200,margin={top:100,right:100,bottom:100,left:175},canvasWidth=2*radius+margin.left+margin.right,canvasHeight=2*radius+margin.top+margin.bottom,color=d3.scale.category10(),legendData=[{label:"Sample",value:300},{label:"Total People",value:72e5}],pi=Math.PI,pie=d3.layout.pie().value(function(t){return t.value}).sort(null),arc=d3.svg.arc().outerRadius(radius).innerRadius(radius/3),range=$(".input-range"),value=$(".range-value");value.html(range.attr("value")),range.on("input",function(){value.html(this.value),showHelp()}),d3.selectAll(".input-range").on("input",function(){nb_sliders=$(this).val(),init()});var outerArc=d3.svg.arc().innerRadius(radius+50).outerRadius(.95*radius);$("li").click(function(){$(this).addClass("active").siblings().removeClass("active")});